---
title: "Problema 4 Checkpoint 1"
author: "Luiza Carvalho"
date: "24 de julho de 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(dplyr)
library(ggplot2)

```
## Introdução

Para essa parte do problema usaremos uma amostra dados de dados da atividade global do github. Os dados brutos contém a contagem de quantas pessoas editaram arquivos com cada extensão de arquivo em cada dia de 2016 e 2017 no github. Não temos dados de todos os repositórios nem de todos os usuários, portanto estamos trabalhando com uma amostra. 

### Perguntas 

Escolha duas linguagens de programação que lhe interessem e responda o seguinte: 

1. Para cada uma delas, há uma diferença significativa na sua popularidade durante a semana e durante o fim de semana? Essa diferença é grande?

2. Existe uma diferença significativa entre as duas linguagens na sua variação de popularidade nos finais de semana?

As linguagens escolhidas foram Java e Python.

## Conhecendo e Manipulando os Dados

O conjunto de dados é uma amostra de dados da atividade global do github, suas variáveis são: a extensão do arquivo, o dia do mês, o mês e o ano em que arquivos com essa extenção foram editados e o número de usuários que editaram os arquivos.

Para responder as perguntas dessa análise precisamos manipular os dados para obeter um dataframe com apenas as duas extensões de arquivos escolhidas (py e java) e também será feita uma manipulação para obtermos o dia da semana equivalente a data em que os arquivos com determinada extensão foram editados.
 
``` {r}
#Importando Dados
dados <- read.csv("github-users-committing-filetypes.csv")

#Selecionando apenas as extensões que serão utilizadas
dados <- dados %>% filter(file_extension == "java" | file_extension == "py")

head(dados)
names(dados)

# Obtendo o dia da semana de cada data
dados <- dados %>% mutate(full_date = paste(month_day, the_month, the_year, sep = '-'))

dados <- dados %>% mutate(week_day= weekdays(as.Date(full_date,'%d-%m-%Y')))

```

Para analisar o panorama das edições dos arquivos por mês foi necessária a criação de mais um campo no dataframe, o qual mostra a soma de todas as edições feitas para cada linguagem de programação em um mês.

```{r}
java <- dados %>% filter(file_extension == "java")

java.2017 <- java %>% filter(the_year == 2017)
java.2016 <- java %>% filter(the_year == 2016)

java.2017 <- java.2017 %>% group_by(the_month) %>% mutate(users_month = sum(users))

java.2016 <- java.2016 %>% group_by(the_month) %>% mutate(users_month = sum(users))

java <- rbind(java.2016,java.2017)

py <- dados %>% filter(file_extension == "py")

py.2017 <- py %>% filter(the_year == 2017)
py.2016 <- py %>% filter(the_year == 2016)

py.2017 <- py.2017 %>% group_by(the_month) %>% mutate(users_month = sum(users))

py.2016 <- py.2016 %>% group_by(the_month) %>% mutate(users_month = sum(users))

py <- rbind(py.2016,py.2017)
```

Aqui então temos o sumário da amostra e as novas variáveis adicionadas ao dataframe que serão utilizadas para está análise.

```{r}

dados <- rbind(py,java)

summary(dados)
names(dados)

```

## Linha do Tempo


```{r, fig.width=9,fig.height=7}

p1 <- java %>% ggplot(aes(x = the_month, y = users_month, colour = as.factor(the_year))) + geom_point()  +geom_line()+  scale_x_continuous(breaks=c(1,3,6,9,12)) + ylim(10000, 160000) + labs(title = "Edições por Mês (Java)", x = "Mês" , y= "Número de Usuários que Fizeram Edições", colour = "Ano")


p2 <- py %>% ggplot(aes(x =the_month, y = users_month, colour = as.factor(the_year))) + geom_point() + geom_line() + ylim(10000, 160000) +  scale_x_continuous(breaks=c(1,3,6,9,12))+ scale_color_manual(values=c("#999999", "#E69F00")) + labs(title = "Edições por Mês (Python)", x = "Mês" , y= "Número de Usuários que Fizeram Edições", colour = "Ano")

require("gridExtra")
grid.arrange(p1, p2)
```

## Popularidade por Dia da Semana

```{r, fig.width=9,fig.height=7}

java <- java %>% group_by(week_day) %>% mutate(user_day = sum(users)) 

py <- py %>% group_by(week_day) %>% mutate(user_day = sum(users))


p1 <- java %>% ggplot(aes(x = week_day, y = user_day)) + geom_point(color="#4286f4")+ ylim(142000, 380000) + scale_x_discrete(limits=c("segunda-feira", "terça-feira", "quarta-feira", "quinta-feira", "sexta-feira", "sábado", "domingo")) + labs(title = "Edições por Dia da Semana (Java)", x = "Dia da Semana" , y= "Usuários que Fizeram Edições")

p2 <- py %>% ggplot(aes(x = week_day, y = user_day)) + geom_point(color="#E69F00")  + scale_y_continuous(limits = c(142000, 380000)) + scale_x_discrete(limits=c("segunda-feira", "terça-feira", "quarta-feira", "quinta-feira", "sexta-feira", "sábado", "domingo")) + labs(title = "Edições por Dia da Semana (Python)", x = "Dia da Semana" , y= "Usuários que Fizeram Edições")

grid.arrange(p1, p2)
                                                                            
```

```{r, fig.width=9,fig.height=7}
week <- c("segunda-feira", "terça-feira", "quarta-feira", "quinta-feira", "sexta-feira", "sábado", "domingo")

users.py <- c(318192, 342855, 341728, 333628, 309929, 177409, 181123)

users.java <- c(245899, 262314, 261528, 254610, 239591, 142507, 147985)
  
py.percent <- as.data.frame(week)
py.percent$users <- users.py
py.percent$total <- sum(users.py)
py.percent$percent <- (py.percent$users / py.percent$total) * 100
py.percent$language <- "py"


java.percent <- as.data.frame(week)
java.percent$users <- users.java
java.percent$total <- sum(users.java)
java.percent$percent <- (java.percent$users / java.percent$total) * 100
java.percent$language <- "java"

total.percent <- rbind(py.percent, java.percent)

total.percent %>% ggplot(aes(x = week, y = percent)) + geom_col(aes(fill = language),stat = "identity",position = "dodge") + scale_x_discrete(limits=c("segunda-feira", "terça-feira", "quarta-feira", "quinta-feira", "sexta-feira", "sábado", "domingo")) + theme(axis.text.x = element_text(angle = 45, hjust = 1)) + labs(title = "Porcentagem de Edições por Dia da Semana", x = "Dia da Semana" , y= "Porcentagem", fill = "Linguagem")

  
```
                                                                                                                                                                                                                                    